<!-- TODO: remove header/footer, move to template  html file -->
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Study Cards</title>
  </head>
  <body class="study_body">
    <ul>
    <h1>Deck: <%= @deck.name %></h1>

<% study_stats = Array.new(@deck.cards.length, 0)%>

<div id="carouselExampleIndicators" class="carousel slide" data-bs-interval="false" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <% @deck.cards.each_with_index do |card, index| %>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to=<%= index %>
        class="
          <%= index.zero? ? 'active' : '' %>
        "
        aria-current="
          <%= index.zero? ? 'true' : 'false' %>
        "
        aria-label="Slide <%= index + 1%>">
        </button>
    <% end %>
  </div>
  <div class="carousel-inner">
    <% @deck.cards.each_with_index do |card, index| %>
      <div
        class="
          study-card
          carousel-item
          <%= index.zero? ? 'active' : '' %>
        "
        data-id="<%= card.id %>"
      >
        <!-- front of card -->
        <div class="card mx-auto card-front" style="width: 18rem;">
          <div class="card-body">
            <h5 class="card-title"><%= card.header %></h5>
            <p class="card-text mb-4"><%= card.lines %></p>
          </div>
        </div>
        <!-- back of card -->
        <div class="card mx-auto visually-hidden card-back" style="width: 18rem;">
          <div class="card-body">
            <p class="card-text mb-4"><%= card.blank %></p>
          </div>
        </div>
      </div>

    <% end %>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>

<br><br>

</div>

<button type="button" class="btn btn-info" onclick="studyCardFlip(this)">Flip</button>
<p>
    <b>Score</b><br />
    <input name="score" type="radio" value="Correct" onclick="studyCardRecordResult(this.value)"/> Correct<br />
    <input name="score" type="radio" value="Incorrect" onclick="studyCardRecordResult(this.value)"/> Incorrect<br />
</p>
<%= link_to "Submit Study", deck_path(@deck), class: "btn btn-success" %>
<%= link_to "Quit study", deck_path(@deck), class: "btn btn-danger" %>

</ul>
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->


    <div class="">
    <!-- <div class="visually-hidden"> -->

      <%= form_with model: @deck.results.build do |form| %>

        <% @deck.cards.each do |card| %>


          <div id="cardResultForm<%= card.id %>">
            <%= form.fields_for :card_results do |card_result_form| %>
              <%= card_result_form.check_box :correct %>
              <%= card_result_form.number_field :card_id, value: card.id %>
            <% end %>
          </div>
          
        <% end %>

        <p>
          <%= form.submit id: "submitResult" %>
        </p>
      <% end %>
    </div>



  </body>
</html>